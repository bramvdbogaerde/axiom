%% Basic Map type tests

syntax {
  key in Key ::= k1() | k2() | k3();
  value in Value ::= v1() | v2() | v3();

  dict in Map(Key, Value);
  result in Result ::= lookupSuccess(value);
};

rules {
  rule "map-lookup-v1"
  [ dict = [ k1() |-> v1() ] ; v1() = dict(k1()) ] =>
  [ lookupSuccess(v1()) ];

  rule "map-lookup-v2"
  [ dict = [k2() |-> v2() ] ; v2() = dict(k2()) ] =>
  [ lookupSuccess(v2()) ];

  rule "map-lookup-v3"
  [ dict = [k3() |-> v3() ] ; v3() = dict(k3()) ] =>
  [ lookupSuccess(v3()) ];
};

%test: lookupSuccess(v1())
%test: lookupSuccess(v2())
%test: lookupSuccess(v3())
