%% This file tests HaskellExpr parsing and execution functionality

syntax {
    a, result, sum, product in Int;
    test in Rules ::= t(result, result);
};

rules {
    rule "Simple-HaskellExpr"
    [ ] =>
    [ t(result, ${42}) ];
    
    rule "Arithmetic-HaskellExpr"
    [ ] =>
    [ t(result, ${10 + 5}) ];

    rule "Var-Access"
    [ a = 5 ] =>
    [ t(result, ${a * 2}) ];
    
    rule "Complex-Arithmetic"
    [ ] =>
    [ t(result, ${6 * 7 + 2}) ];
};

%% Test queries to verify Haskell expressions execute correctly
%test: t(result, 42)
%test: t(sum , 15)
%test: t(product, 44)
%test: t(result, 10)
